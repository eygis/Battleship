(()=>{"use strict";let e=e=>{let t=new Array(e).fill(!1);return{length:e,hits:t,get isSunk(){return t.every((e=>e))},hit:e=>{t.splice(e,1,!0)}}},t=()=>{const t={xsmall:e(2),small:e(3),medium:e(4)};let r={xsmall:null,small:null,medium:null,misses:[],shots:[]},o=(e,t)=>e.length===t.length&&e.every(((e,r)=>e===t[r])),l=e=>{let t=!0;return r.shots.forEach((r=>{o(r,e)&&(t=!1)})),t};return{get coordinates(){return r},generateCoordinates:e=>{for(;null==r[e];){let l=[],a=!0,n=[];for(let r=0;r<2;r++)n.push(Math.floor(Math.random()*(11-t[e].length))+1);l.push(n);for(let r=0,o=n[1]+1;r<t[e].length-1;r++,o++){let e=[n[0]];e.push(o),l.push(e)}for(let e=0;e<l.length;e++)for(let t=0;t<Object.values(r).length;t++)if(null!=Object.values(r)[t])for(let n=0;n<Object.values(r)[t].length;n++)o(Object.values(r)[t][n],l[e])&&(a=!1);1==a&&(r[e]=l)}},receiveAttack:(e,a)=>{let n=!1;Object.values(r).forEach(((c,s)=>{null!=c&&s!=Object.keys(r).length-1&&c.forEach(((r,c)=>{if(o(r,e)&&l(e)){let r=Object.keys(t)[s];t[r].hit(c),document.querySelectorAll(`[data-coordinate="${e}"]`)["player"==a?0:1].style.backgroundColor="red",n=!0}}))})),0==n&&l(e)&&r.misses.push(e),r.shots.push(e)},allSunk:()=>{for(let e in t)if(0==t[e].isSunk)return!1;return!0},checker:o,shotsChecker:l,ships:t}};const r=t().checker,o=t().ships,l=(()=>{let e=()=>{const e=t();return Object.keys(o).forEach((t=>{e.generateCoordinates(`${t}`)})),e},l={ships:o,board:e()},a={ships:o,board:e()};return{human:l,computer:a,computerAttack:()=>{let e=()=>Math.floor(10*Math.random())+1,t=[e(),e()],o=()=>{let e=!0;return l.board.coordinates.shots.forEach((o=>{r(o,t)&&(e=!1)})),e};for(;!o();)t=[e(),e()];l.board.receiveAttack(t,"player")}}})();let a=()=>{let e=l.human.board.coordinates.misses,t=l.computer.board.coordinates.misses;for(let t=0;t<e.length;t++)document.querySelectorAll(`[data-coordinate="${e[t]}"]`)[0].style.backgroundColor="grey";for(let e=0;e<t.length;e++)document.querySelectorAll(`[data-coordinate="${t[e]}"]`)[1].style.backgroundColor="grey"};(()=>{let e=document.querySelector("#playerContainer"),t=document.querySelector("#computerContainer");for(let r=1;r<=10;r++){let o=document.createElement("div"),n=document.createElement("div");o.classList.add("row","player"),n.classList.add("row","computer");for(let e=1;e<=10;e++){let t=document.createElement("div");t.classList.add("tile","player"),t.textContent="",t.dataset.coordinate=[e,r],o.appendChild(t);let c=document.createElement("div");c.classList.add("tile","computer"),c.textContent="",c.dataset.coordinate=[e,r],c.addEventListener("click",(e=>{let t=e.target.dataset.coordinate.split(","),r=[];t.forEach((e=>r.push(parseInt(e)))),l.computer.board.shotsChecker(r)&&(l.computer.board.receiveAttack(r,"computer"),a(),l.computer.board.allSunk()&&window.alert("You win!"),l.computerAttack(),a(),l.human.board.allSunk()&&window.alert("Computer wins :("))})),n.appendChild(c)}e.appendChild(o),t.appendChild(n)}let r=l.human.board.coordinates.xsmall,o=l.human.board.coordinates.small,n=l.human.board.coordinates.medium;l.computer.board.coordinates.xsmall,l.computer.board.coordinates.small,l.computer.board.coordinates.medium;for(let e=0;e<2;e++)document.querySelectorAll(`[data-coordinate="${r[e]}"]`)[0].style.backgroundColor="green";for(let e=0;e<3;e++)document.querySelectorAll(`[data-coordinate="${o[e]}"]`)[0].style.backgroundColor="blue";for(let e=0;e<4;e++)document.querySelectorAll(`[data-coordinate="${n[e]}"]`)[0].style.backgroundColor="yellow"})(),a()})();